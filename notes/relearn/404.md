# 搭建系统：大量的低价值需求应该如何应对？

这类页面技术难度不高，业务上通常属于“紧急不重要”的事情

所谓工程师，就是为了解决这些问题而存在的岗位，我们从工程的视角来看，“大量紧急不重要的页面”，才是真正的需求，现在需求有了，我们就应该按照工程的方式，定目标、设计方案、做实施、拿结果来解决问题。

## 搭建系统的目标

搭建系统的目标是解决大量的简单页面生产问题，衡量这个目标的指标应该是生产页面的数量

要做搭建系统，可以根据业务的体量和服务的范围来决定具体的指标要求

## 搭建系统的设计

不同流派：
- 模版化搭建，由前端工程师生产页面模板，再由运营提供数据来完成页面
  - 理解公式：`模版 + 数据 = 页面`
  - 是一种简单的思路，优点是整个系统实现简单
- 模块化搭建，由前端工程师生产模块，由运营把模块和数据组织成页面
- 数据驱动界面，这是一种比较新的思路，即数据中包含了展现自身所需要的模块相关的信息，本身决定了界面

### 数据，是用于展现界面所需要的信息

按照数据用途分类：
- 界面配置数据：决定了页面上颜色、尺寸、位置、图片、文字等展现形式的数据，通常是以页面为单位的配置
- 内容数据：页面要展示的信息，如电商活动的商品信息、文章的文字信息等

按照数据来源：
- 运营手工填写固定数据：运营人员依靠自己的专业技能决定的数据，可能包含线下招商信息、商品选品、文章等
- 来自 API 的数据：
  - 固定数据，由服务端逻辑到指定存储处获取的数据
  - 用户相关数据，由算法系统或者服务端逻辑，根据用户信息或者用户喜好推荐的数据

搭建系统的数据部分有 2 个难点：
1. 数据的手工编辑能力，现在一般的数据都会采用 JSON 格式，JSON 格式中有数字、字符串、数组、对象、布尔等数据类型，我们需要根据数据的格式定义为每一种类型设计编辑器
   - 整数：整数编辑器，可用 HTML 原生输入框 `<input type=number min=1 max=100>` 实现
   - 数字：数字编辑器，可用 `<input type=number min=1.0 max=100.0>` 实现
   - 字符串： 字符串编辑器，可用 `<input />` 实现
   - URL：URL 编辑器，可用 `<input />` 配合格式校验
   - 图片：图片编辑器，需要自研图片上传功能
   - 固定字符对象：对象和字段编辑器，可用多个 `<input />` 和 `<label>` 实现
   - 布尔型：开关，可用 `<select>` 或者自研组件来实现
   - 自由字段对象: 需要自研 `KV` 输入组件
   - 数组：需要自研列表组件实现
   - 对象数组：需要自研表格组件获取列表组件实现，很多时候来自 `Excel`，需要重视 `Excel` 导入
   - 矩形区域：需要自研区域选择组件
2. 跟服务端 API 的对接，对于服务端统一性较好的公司，这不是什么难事，统一性不好的公司，就非常麻烦


### 模板

模板可以简单得理解成挖了许多坑的页面，它一般是由前端工程师来生产的一种实体。与数据之间的连接是数据的格式，对 JSON 格式来说，JSON Schema 是社区接受度较高的一个方案。

最简单的模板可以用字符串模板来设计，复杂一点的模板则可以由 JavaScript 进行渲染，通过约定全局变量名称或者约定调用函数入口做到把数据传递给模板，你可以根据实际需求复杂程度选择合适的方案。

模板可不是“增、删、改、查”那么简单，考虑到实际工程需要，模板必须是版本化的，前端每发布一个模板，都需要永久性存储一条记录，并且产品设计上必须保持可以回滚，这样，一旦线上发现问题，可以迅速回滚到一个可工作的版本，有效降低不可用时长。

模板设计还有批量更新的需求，一些运营活动可能包含数百个页面，它们使用同一套模板，产品设计上必须要注意提供批量更新机制


### 模块

模块跟模板非常相似，但是从产品的角度，模块是可组合的。跟模板相似的部分如数据连接、版本化发布、批量更新等

模块化搭建有额外的技术难点，就是可拖拽的模块编辑器，移动端搭建布局相对简单，可以通过简单的自上而下布局和拖拽改变位置来实现。

桌面的模块拖拽比较复杂，一般都会采用一些变通的思路简化设计，如提供几种固定的布局模板，提供布局容器，或者采用纯绝对定位布局。

在一些产品设计中，会先用模块拼成模板，再指定数据源，这种模式中的“模块”，我们认为是一种开发模板的技术方案，跟我们此处讲的产品上的模块概念不同

模板应该是由前端工程师产生的，具有复用性的一种实体

### 页面

最终生产的目标都是页面。页面同样需要版本化发布，便于回滚。

页面部分实现的难点是跟发布系统的结合

假设前端持续集成系统有校验规则，页面也必须经过这个过程

可通过自建静态 `Web` 服务器 + `CDN` 回源的方式来支撑搭建系统的线上应用的。因为服务器上只发布静态内容，并且有 `CDN` 挡住用户流量，所以只需要少量几台线上机器即可。

## 搭建系统的实施

只要正确识别了需求，搭建系统的推行几乎完全不需要担心

## 搭建系统的监控

搭建系统的 __用户访问__ 和 __生产页面数量__ 是衡量自身的重要指标


